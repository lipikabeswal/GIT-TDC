<canvas width="100%" height="100%">
<include href="manipulatives/protractor/Protractor.lzx" />
<include href="manipulatives/calculator/scientificCalculator.lzx"/>
<include href="manipulatives/calculator/standardCalculator.lzx"/>
<include href="manipulatives/ruler/BaseRuler.lzx"/>
<include href="manipulatives/ruler/MaskingRuler.lzx"/>
<include href="manipulatives/scratchpad/Scratchpad.lzx"/>
<include href="manipulatives/refcard/RefCard.lzx"/>
<include href="manipulatives/PleaseWaitPopup.lzx"/>
	
<attribute name="srcurl" value="null"/>
<attribute name="manipid" value="null"/>
<attribute name="isLoaded" type="boolean" value="false"/>
<attribute name="scratchpadtext" value="null"/>
<attribute name="freezeui" value="null"/>
<attribute name="unlockui" value="null"/>
<attribute name="showpleasewaitpopup" type="boolean" value="false"/>
<attribute name="hidepleasewaitpopup" type="boolean" value="false"/>
<attribute name="showpleasewaitpopupcontrols" type="boolean" value="false"/>
<attribute name="manipulativedata" type="boolean" value="false"/>
<attribute name="htmlGeneralManip" value="$once{new Object()}" />
<attribute name="scalefactor" value="null"/>
<attribute name="xscalefactor" value="null"/>

<attribute name="yscalefactor" value="null"/>

<handler name="onscalefactor" args="data">		
	data = data.split('|');
	this.xscalefactor = Number(data[0]);
	this.yscalefactor = Number(data[1]);
</handler>

<handler name="onshowpleasewaitpopup">
	console.log("onshowPleaseWaitPopup",this.showPleaseWaitPopup);
	gPleaseWaitPopup.show();
</handler>

<handler name="onhidepleasewaitpopup">
	gPleaseWaitPopup.hide();
</handler>

<handler name="onshowpleasewaitpopupcontrols">
	gPleaseWaitPopup.showControls();
</handler>

<handler name="onmanipulativedata" args="data">
	htmlGeneralManip['cm_ruler'] = gCmRuler;
	htmlGeneralManip['formula_card'] = gFcatFormulaCard;
	htmlGeneralManip['half_inch_ruler'] = gHalfInchRuler;
	htmlGeneralManip['mm_ruler'] = gMmRuler;
	htmlGeneralManip['oneeighth_inch_ruler'] = gEighthInchRuler;
	htmlGeneralManip['protractor'] = gProtractor;
	htmlGeneralManip['scientific_calculator'] = gScientificCalculator;
	htmlGeneralManip['standard_calculator'] = gStandardCalculator;

	var js = "setHtmlGeneralManip('"+htmlGeneralManip+"')";
	lz.Browser.loadJS(js);
</handler>

<handler name="onfreezeui" args="data">
 this.blocker.setAttribute('visible',true);
</handler>

<handler name="onunlockui" args="data">
this.blocker.setAttribute('visible',false);
</handler>

<handler name="onsrcurl" args="arg"><![CDATA[
if (!isLoaded){
var url;
//For Previewer
if (arg.indexOf("http") != -1){
	url = arg;
}else{
	url = "http:items/"+arg+"/previewer.html";
}



this.ht.setAttribute('src', url);
this.ht.sendToBack();
canvas.setAttribute('isLoaded', true);
}
]]></handler>

<handler name="onscratchpadtext" args="arg"><![CDATA[
	//console.log("on scratchpad text" + arg);
	gScratchpad.setText(arg);	
]]></handler>

<handler name="onmanipid" args="arg">
	<![CDATA[
//console.log("onmanipid" , arg);
var accom = document.getElementById('__lz0').contentWindow.accomPkg;
switch(arg){

		case 'highlighter': if(accom.enableHighlighterArea){
								accom.enableHighlighter(false);
							}else{
								accom.enableHighlighter(true);	
							}
							
		break;
		case 'eraser' :		if(accom.enableEraserArea){
								accom.enableEraser(false);
							}else{
								accom.enableEraser(true);
							}
		break;
		case 'protractor' : if(gProtractor.visible){
								gProtractor.hide();
							}else{
								gProtractor.show();
							}
		break;
		
		case 'standard_calculator' : if(gStandardCalculator.visible){
								gStandardCalculator.hide();
							}else{
								gStandardCalculator.show();
							}
		break;
		
		case 'scientific_calculator' :if(gScientificCalculator.visible){
								gScientificCalculator.hide();
							}else{
								gScientificCalculator.show();
							}
		break;
		

		case 'straight_edge' :if(gStraightEdge.visible){
										gStraightEdge.hide();
									}else{
										gStraightEdge.show();
									}
				break;
		case 'oneeighth_inch_ruler' :if(gEighthInchRuler.visible){
										gEighthInchRuler.hide();
									}else{
										gEighthInchRuler.show();
									}
				break;
		case 'half_inch_ruler' :if(gHalfInchRuler.visible){
										gHalfInchRuler.hide();
									}else{
										gHalfInchRuler.show();
									}
				break;
		case 'mm_ruler' :if(gMmRuler.visible){
										gMmRuler.hide();
									}else{
										gMmRuler.show();
									}
				break;
		case 'cm_ruler' :if(gCmRuler.visible){
										gCmRuler.hide();
									}else{
										gCmRuler.show();
									}
				break;
				
		case 'masking_ruler' : 	if(gMaskingRuler.visible){
									gMaskingRuler.hide();
								}else{
									gMaskingRuler.show();
								}
		break;
		
		case 'scratchpad' : 	if(gScratchpad.visible){
									gScratchpad.hide();
								}else{
									gScratchpad.show();
								}
		break;

		case 'FCAT_formula_card' : if(gFcatFormulaCard.visible){
										gFcatFormulaCard.hide();
									}else{
										gFcatFormulaCard.show();
									}

		break;

		case 'TN_formula_card' : if(gTnFormulaCard.visible){
										gTnFormulaCard.hide();
									} else{
										gTnFormulaCard.show();
									}



		break;

		
		default :
			//console.log('gscratchpad.vsisible', gScratchpad.visible);
			gScratchpad.bringToFront();
						
		break;

}

]]>
</handler>
<!--  <view name="wrapper" x="5" y="150" width="800" height="560" bgcolor="green">
<html id="ht" name="htTag"  x="5" y="5" width="790" height="550"/>
</view>


<button name="visibleinvi" y="10" text="toggleVisiblity">
	<handler name="onclick">
		ht.setAttribute('visible' , false);
	</handler>
</button>

<button text="LISTEN_AUTO_NRS.html" y="20">
	<handler name="onclick">
	if($dhtml){
	ht.setAttribute('src', this.text);
	}else{
	ht.setAttribute('visible' , true);
	ht.setAttribute('src', 'http:audio/' + this.text);
	}
	</handler>
</button>-->

	<view name="wrapper" width="${760 * xscalefactorjs}" height="${450 * yscalefactorjs}" >
	<Protractor name="protractor" toolid="protractor" id="gProtractor" xscale="$immediately{xscalefactorjs}" yscale="$immediately{yscalefactorjs}"/>

	<standardCalculator name="standard_calculator"
		toolid="standard_calculator" id="gStandardCalculator" xscale="$immediately{xscalefactorjs}" yscale="$immediately{yscalefactorjs}"/>

	<scientificCalculator name="scientific_calculator"
		toolid="scientific_calculator" id="gScientificCalculator" xscale="$immediately{xscalefactorjs}" yscale="$immediately{yscalefactorjs}"/>
	<BaseRuler name="straight_edge" toolid="straight_edge"
		labelrsr="straight_label" id="gStraightEdge" xscale="$immediately{xscalefactorjs}" yscale="$immediately{yscalefactorjs}"/>


	<BaseRuler name="oneeighth_inch_ruler" toolid="oneeighth_inch_ruler"
		tickmarksrsr="eighth_inch_tick_marks" labelrsr="inches_label"
		id="gEighthInchRuler" xscale="$immediately{xscalefactorjs}" yscale="$immediately{yscalefactorjs}"/>

	<BaseRuler name="half_inch_ruler" toolid="half_inch_ruler"
		tickmarksrsr="half_inch_tick_marks" labelrsr="inches_label"
		id="gHalfInchRuler" xscale="$immediately{xscalefactorjs}" yscale="$immediately{yscalefactorjs}"/>

	<BaseRuler name="mm_ruler" toolid="mm_ruler"
		tickmarksrsr="millimeter_tick_marks" labelrsr="centimeters_label"
		id="gMmRuler" xscale="$immediately{xscalefactorjs}" yscale="$immediately{yscalefactorjs}"/>

	<BaseRuler name="cm_ruler" toolid="cm_ruler"
		tickmarksrsr="centimeter_tick_marks" labelrsr="centimeters_label"
		id="gCmRuler" xscale="$immediately{xscalefactorjs}" yscale="$immediately{yscalefactorjs}"/>

	<MaskingRuler name="masking_ruler" toolid="masking_ruler"
		labelrsr="masking_label" id="gMaskingRuler" xscale="$immediately{xscalefactorjs}" yscale="$immediately{yscalefactorjs}"/>

	<Scratchpad name="scratchpad" toolid="scratchpad" id="gScratchpad" xscale="$immediately{xscalefactorjs}" yscale="$immediately{yscalefactorjs}"/>
	
	<RefCard name="FCAT_formula_card" 
                 toolid="FCAT_formula_card"
                 refCardRsrc="FCAT_refcard_contents"
                 titleRsrc="FCAT_refcard_title"
                 scrolls="true"
                 id="gFcatFormulaCard" xscale="$immediately{xscalefactorjs}" yscale="$immediately{yscalefactorjs}"/>
    <RefCard name="TN_formula_card" 
                 toolid="TN_formula_card"
                 refCardRsrc="TN_refcard_contents"
                 titleRsrc="TN_refcard_title"
                 scrolls="false"
                 id="gTnFormulaCard" xscale="$immediately{xscalefactorjs}" yscale="$immediately{yscalefactorjs}"/>
             </view>
             
           
<view name="blocker" x="5" y="5" width="${760 * xscalefactorjs}" height="${450 * yscalefactorjs}" opacity="0.01">
<handler name="oninit">
	this.bringToFront();
	var elem = this.getDisplayObject();
	elem.setAttribute('id','htmlUIBlock');
</handler>
</view>

<html id="ht" name="ht" x="5" y="5" width="${760 * xscalefactorjs}" height="${450 * yscalefactorjs}" scrollbars="false" >
 	<handler name="onload">
 	this.sendToBack();
 	parent.blocker.bringToFront();
 	</handler>
 	 <handler name="oninit">
 	this.sendToBack();
 	parent.blocker.bringToFront();
 	</handler>
 </html>


<handler name="oninit">
	this.setAttribute("bgcolor", null);
	var s = "getSPTextInitial()";
	lz.Browser.loadJS(s);
</handler>


<!--<handler name="onclick">
var coord = this.getMouse ('x') + "|"+ this.getMouse ('y')  +"|click";
var s = "passCoordinates('"+coord+"')";
lz.Browser.loadJS(s);	
</handler>



<handler name="onmousedown">
var coord = this.getMouse ('x') + "|"+ this.getMouse ('y')  +"|mousedown";
var s = "passCoordinates('"+coord+"')";
lz.Browser.loadJS(s);
moustracker_del.register(lz.Idle,'onidle');

</handler>

<handler name="onmouseup">
<![CDATA[
var coord = this.getMouse ('x') + "|"+ this.getMouse ('y')  +"|mouseup";
var s = "passCoordinates('"+coord+"')";
lz.Browser.loadJS(s);
moustracker_del.unregisterAll();


]]>
</handler>

<method name="trackmouse" args="v">

var coord = this.getMouse ('x') + "|"+ this.getMouse ('y')  +"|mousemove";
var s = "passCoordinates('"+coord+"')";
lz.Browser.loadJS(s);
</method>


	<view width="200" height="200" bgcolor="red">
		<dragstate name="dragger"/>
		<handler name="onmousedown">dragger.apply();</handler>
		<handler name="onmouseup">dragger.remove();</handler>
	</view>-->
</canvas>
