
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<link rel="SHORTCUT ICON"
	href="http://www.laszlosystems.com/favicon.ico">
<meta name="viewport" content="width=device-width; initial-scale=1.0;">
<title>OpenLaszlo 4.9.0: Test (lps-4.9.0/manip/Test)</title>

<script type="text/javascript" src="lps-dhtml/lps/includes/embed-compressed.js"></script>
<script type="text/javascript" src="includes/utils.js"></script>
<!--[if lt IE 9]><script type="text/javascript" src="lps-dhtml/lps/includes/excanvas.js"></script><![endif]-->
<style type="text/css">

textarea{
    resize:none;
}

::-webkit-scrollbar {
  width: 12px;
  height: 12px; }
 
::-webkit-scrollbar:hover {
  height: 18px; }
 
::-webkit-scrollbar-button:start:decrement,
::-webkit-scrollbar-button:end:increment {
  height: 15px;
  width: 13px;
  display: block;
  background: #D7D7D7;
  background-repeat: no-repeat; }
 
::-webkit-scrollbar-button:vertical:increment {
  background-image: url(lps/resources/lps/components/lz/resources/scrollbar/autoPng/scrollbtn_y_bot_up.png);
  background-position: 0px 0px; }
 
::-webkit-scrollbar-button:vertical:decrement {
  background-image: url(lps/resources/lps/components/lz/resources/scrollbar/autoPng/scrollbtn_y_top_up.png);
  background-position: 0px 0px; }
 
::-webkit-scrollbar-button:vertical:increment:active {
  background-image: url(lps/resources/lps/components/lz/resources/scrollbar/autoPng/scrollbtn_y_bot_dn.png); }
 
::-webkit-scrollbar-button:vertical:decrement:active {
  background-image: url(lps/resources/lps/components/lz/resources/scrollbar/autoPng/scrollbtn_y_top_dn.png); }
 
::-webkit-scrollbar-track-piece {
  background-image: url(lps/resources/lps/components/lz/resources/scrollbar/y_scrolltrack.png); }
 
::-webkit-scrollbar-thumb:vertical {
  height: 5px;
  /*background-image: url(lps/resources/lps/components/lz/resources/scrollbar/autoPng/scrollthumb_y_mid.png);*/
  
  border: 1px solid #0d0d0d;
  border-top: 1px solid #666666;
  border-left: 1px solid #666666; 
  background-color: #D7D7D7;
	/*//border: 1px solid #eee;*/
  }


 
 

</style>
<style type="text/css">
html,body { /* http://www.quirksmode.org/css/100percheight.html */
	height: 100%;
	/* prevent browser decorations */
	margin: 0;
	padding: 0;
	border: 0 none;
}

body {
	background-color: #ffffff;
	/*transform: translate(10%, 10%) scale(1.33, 1.33);*/
	/*-moz-transform: translate(10%, 10%) scale(1.33, 1.33);*/
	/*-ms-transform: translate(10%, 10%) scale(1.33, 1.33);*/
	/*-webkit-transform: translate(-25%, -25%) scale(0.5, 0.5);*/
	/*-o-transform: translate(-25%, -10%) scale(0.5, 0.8);*/
}





#__lz0 { 
	/*transform: translate(-25%, -25%) scale(0.5, 0.5);*/
	/*-moz-transform: translate(0%, 0%) scale(0.8, 0.8);*/
	/*-ms-transform: translate(-25%, -25%) scale(0.5, 0.5);*/
	/*-webkit-transform: translate(-25%, -25%) scale(0.5, 0.5);*/
	/*-o-transform: translate(-25%, -10%) scale(0.5, 0.8);*/
}

img {
	border: 0 none;
}
</style>
<!--[if IE]>
        <style type="text/css">
            /* Fix IE scrollbar braindeath */
            html { overflow: auto; overflow-x: hidden; }
        </style>
        <![endif]-->
        
<script type="text/javascript">
	    var xscalefactorjs = window.parent.xscalefactor;
        var yscalefactorjs = window.parent.yscalefactor;
        if(!xscalefactorjs){
        	xscalefactorjs = 1.2;
        }
        if(!yscalefactorjs){
        	yscalefactorjs = 1.2;
        }
        //console.log('xscalefactor',xscalefactorjs,yscalefactorjs);

</script>        
</head>
<script>
	window.onmouseup = function () {
		window.parent.fromWrapper();
	}
        var itemSet = false;
        var ansSet = false;
        var readable = false;
        var iid = null;
        var iframeLoaded = false;
        
        function isAnswered(){
        var elem = document.getElementById('__lz1');
	      	if(elem){
	      	if(elem.contentWindow.accomPkg)
	       	return elem.contentWindow.accomPkg.isItemAnswered();
	      }        	
        }
        
        function getState(){
         var elem = document.getElementById('__lz1');
        if(elem){
        		if(elem.contentWindow.accomPkg)
        		return document.getElementById('__lz1').contentWindow.accomPkg.getState();
        	}        
        }
        
        function setState(htmlContent,jsonContent,checkedVals){
        	var elem = document.getElementById('__lz1');
        	if(elem){	
	           if(elem.contentWindow){
	           		
	           		if(document.getElementById('__lz1').contentWindow.accomPkg && ansSet == false){
	        		//console.log("ansSet", ansSet,document.getElementById('__lz1').contentWindow.accomPkg.isContentLoaded());
	        			document.getElementById('__lz1').contentWindow.accomPkg.setState(htmlContent,jsonContent,checkedVals);
	        			ansSet = true;
	        		}
	        		document.getElementById('__lz1').contentWindow.accomPkg.setFocusItem();
	        	}
        	}          
        }
        
        function setItemId(itemId){
        	//console.log("itemSet", itemSet);
  				iframeState();
	        	if (itemSet == false){
	        	lz.embed.setCanvasAttribute('srcurl',itemId);
	        	iid = itemId;
	        	itemSet = true;
	        		
	        	}
        }
        
        function iframeState(){
        	var iframe = document.getElementById('__lz1');
        	if(iframe){
				if (navigator.userAgent.indexOf("MSIE") > -1 && !window.opera) {
					  iframe.onreadystatechange = function(){
					    if (iframe.readyState == "complete"){
					      	window.parent.setAnswerNow('complete');
					  		var stat = window.parent.getReadable();
					    	readable =  stat == "true"? true: false;
					 		var fontObj = window.parent.getFontAccomodation();	
					 		var bgColorObj = window.parent.getBackColorAccomodation();				    	
					    	if(fontObj.hasFont == 'true'){
					    			document.getElementById('__lz1').contentWindow.accomPkg.setVisualAccessFeatures(fontObj.fgcolor, '12px',bgColorObj);
					    	}else{
					    		document.getElementById('__lz1').contentWindow.accomPkg.setVisualAccessFeatures('', '12px',bgColorObj);
					    	}			    	
					      	var xscalefact = (780 * xscalefactorjs)/800;
					    	var yscalefact = (450 * yscalefactorjs)/462;
					    	document.getElementById('__lz1').contentWindow.translate(xscalefact, yscalefact);
					      	//document.getElementById('__lz1').contentWindow.translate(xscalefactorjs,yscalefactorjs);
					    }
					  };
					} else {
					  iframe.onload = function() {
					    window.parent.setAnswerNow('complete');
					    //check whether iFrame loaded successfully or not
					    if(document.getElementById('__lz1') != null
				    		&& document.getElementById('__lz1').contentWindow != null
				    		&& typeof document.getElementById('__lz1').contentWindow.accomPkg != 'undefined') {
					    	iframeLoaded = true;
					    }
					    var stat = window.parent.getReadable();
					    readable =  stat == "true"? true: false;
					    unlockUI();
					    window.parent.setIframeIsLoaded();
					    if(readable){
					    	document.getElementById('read_btn').style.display = "block";
					    }else{
					    	document.getElementById('read_btn').style.display = "none";
					    }
			     		var fontObj = window.parent.getFontAccomodation();	
			     		var bgColorObj = window.parent.getBackColorAccomodation();				    	
			     		
				    	if(fontObj.hasFont == 'true'){
			    			document.getElementById('__lz1').contentWindow.accomPkg.setVisualAccessFeatures(fontObj.fgcolor, '12px',bgColorObj);
				    		lz.embed.setCanvasAttribute('hasfontaccom',true);
				    	}else{
				    		document.getElementById('__lz1').contentWindow.accomPkg.setVisualAccessFeatures('', '12px',bgColorObj);
				    		lz.embed.setCanvasAttribute('hasfontaccom',false);
				    	}
				    	var manip = window.parent.getOpenManipData();
				    	if(manip != 'null')
				    		showOpenManipulative(manip);
				    	
				    	/* protractor.style.webkitTransform  = "scale("+xscalefactorjs+", "+yscalefactorjs+")";
				    	 standard_calculator.style.webkitTransform  = "scale("+xscalefactorjs+", "+yscalefactorjs+")";
				    	 scientific_calculator.style.webkitTransform  = "scale("+xscalefactorjs+", "+yscalefactorjs+")";
				    	 straight_edge.style.webkitTransform  = "scale("+xscalefactorjs+", "+yscalefactorjs+")";
				    	 oneeighth_inch_ruler.style.webkitTransform  = "scale("+xscalefactorjs+", "+yscalefactorjs+")";
				    	 half_inch_ruler.style.webkitTransform  = "scale("+xscalefactorjs+", "+yscalefactorjs+")";
				    	 mm_ruler.style.webkitTransform  = "scale("+xscalefactorjs+", "+yscalefactorjs+")";
				    	 cm_ruler.style.webkitTransform  = "scale("+xscalefactorjs+", "+yscalefactorjs+")";
				    	 masking_ruler.style.webkitTransform  = "scale("+xscalefactorjs+", "+yscalefactorjs+")";
				    	 scratchpad.style.webkitTransform  = "scale("+xscalefactorjs+", "+yscalefactorjs+")";
				    	 FCAT_formula_card.style.webkitTransform  = "scale("+xscalefactorjs+", "+yscalefactorjs+")";
				    	 TN_formula_card.style.webkitTransform  = "scale("+xscalefactorjs+", "+yscalefactorjs+")";*/
				    	lz.embed.setCanvasAttribute('readable',stat);
				    	var xscalefact = (780 * xscalefactorjs)/800;
				    	var yscalefact = (450 * yscalefactorjs)/462;
				    	document.getElementById('__lz1').contentWindow.translate(xscalefact, yscalefact);
				    	//document.getElementById('__lz1').contentWindow.translate(xscalefactorjs, (450 * yscalefactorjs)/600);
				    	initScratchpad(fontObj.hasFont);
				    	var scratchPadLatest = window.parent.scratchpadManager.getCounter();
				    	var manipObjectAtCounter = window.parent.scratchpadManager.getObjectAtCounter(scratchPadLatest);
						if(manipObjectAtCounter.state == true){
				    		gScratchpad.show(manipObjectAtCounter);
						}
				  };
				  initFrame();
			}
          }
        }
       
        function initFrame() {
        
       		if(document.getElementById('__lz1') != null
	    		&& document.getElementById('__lz1').contentWindow != null
	    		&& typeof document.getElementById('__lz1').contentWindow.accomPkg != 'undefined') {
	    	
		    	var stat = window.parent.getReadable();
			    readable =  stat == "true"? true: false;
			    //check whether iFrame loaded successfully or not
			    iframeLoaded = true;
			    //window.parent.setAnswerNow('complete');
			    if(readable){
			    	if(document.getElementById('read_btn') != null) {
			    		document.getElementById('read_btn').style.display = "block";
			    	}
			    } else {
			    	if(document.getElementById('read_btn') != null) {
			    		document.getElementById('read_btn').style.display = "none";
			    	}
			    }
	     		var fontObj = window.parent.getFontAccomodation();	
	     		var bgColorObj = window.parent.getBackColorAccomodation();				    	
	     				
		    	if(fontObj.hasFont == 'true'){
    				document.getElementById('__lz1').contentWindow.accomPkg.setVisualAccessFeatures(fontObj.fgcolor, '12px',bgColorObj);
    				lz.embed.setCanvasAttribute('hasfontaccom',true);
		    	} else {
	    			document.getElementById('__lz1').contentWindow.accomPkg.setVisualAccessFeatures('', '12px',bgColorObj);
	    			lz.embed.setCanvasAttribute('hasfontaccom',false);
		    	}
		    	var manip = window.parent.getOpenManipData();
		    	if(manip != 'null')
		    		showOpenManipulative(manip);
		    		
	    	  	lz.embed.setCanvasAttribute('readable',stat);
	    	  	var xscalefact = (780 * xscalefactorjs)/800;
		    	var yscalefact = (450 * yscalefactorjs)/462;
		    	document.getElementById('__lz1').contentWindow.translate(xscalefact, yscalefact);
		    	document.getElementById('__lz1').contentWindow.isReadable(readable);
		    	//document.getElementById('__lz1').contentWindow.translate(xscalefactorjs, (450 * yscalefactorjs)/600);
		    	initScratchpad(fontObj.hasFont);
		    	var scratchPadLatest = window.parent.scratchpadManager.getCounter();
		    	var manipObjectAtCounter = window.parent.scratchpadManager.getObjectAtCounter(scratchPadLatest);
				if(manipObjectAtCounter.state == true){
		    		gScratchpad.show(manipObjectAtCounter);
				}
			}
		}
        
        function setTTSText(text){
        	//console.log(text);
        	if(text && readable)
        	window.parent.setTTStext(text);
        }
        
        function showHideManipulative(arg){
        var interval;
        	if(iframeLoaded){
        		lz.embed.setCanvasAttribute('manipid',arg);
        		clearTimeout(interval);
        	}else{
        		arg = arg;
        		interval = setTimeout(function(){
        		showHideManipulative(arg);        			
        		}, 1000);		
        	}
        }
        
        function showOpenManipulative(arg){
        	lz.embed.setCanvasAttribute('manipData',arg);
        }
        
        function setScratchPadText(arg){
        	lz.embed.setCanvasAttribute('scratchpadtext',arg);
        }
        
        function getScratchPadText(){
        	return document.getElementById('textcont').value;
        }
        
        function updateScratchPadText(a){
        	window.parent.setSPText(a);
        }    
        
        function getSPTextInitial(){
        	//console.log("GETSPTEXTINITIAl: "+ window.parent.spText);
        	var text = window.parent.spText;
        	if(text){
        	lz.embed.setCanvasAttribute('scratchpadtext',text);
        	}
        }    
        
        function passManipulativeState(args){
        	//console.log("passmanipulative state: ", args);
        	window.parent.setManipState(args);
        	
        }
        
       function freezeUI(){
       
       	lz.embed.setCanvasAttribute('freezeui', 'freeze');
       }
       
       function unlockUI(){
       
       	lz.embed.setCanvasAttribute('unlockui', 'unlock');
       }
       
       function showPleaseWaitPopup(arg){
       	lz.embed.setCanvasAttribute('showpleasewaitpopup', 'true');
       	//gPleaseWaitPopup.show();
       	//console.log("popupcalled");
       }
       
       function hidePleaseWaitPopup(arg){
       
       	lz.embed.setCanvasAttribute('hidepleasewaitpopup', 'true');
       }
       
       function showPleaseWaitPopupControls(arg){
       
       	lz.embed.setCanvasAttribute('showpleasewaitpopupcontrols', 'true');
       }
       
       function exitPleaseWaitPopup(){
       		window.parent.exitPleaseWaitPopup();
       }
       function getManipulativeData(args){
       		lz.embed.setCanvasAttribute('manipulativedata', args);
       }
       function setHtmlGeneralManip(htmlGeneralManip){
       		window.parent.setHtmlGeneralManip(htmlGeneralManip);
       }
       
       function setCanvasMouseUp(){
       		window.parent.setMouseUpVal('true');
       }
       
       function getScratchpadCoordinates(){
       	if(textAreaElement){
       		//Storing in parent for TE items sync
       		window.parent.setSPText(textAreaElement.value);
       		//For regular Items sync
       		return gScratchpad.x +"|"+ gScratchpad.y + "|" + textAreaElement.value;	
       	}
       	return gScratchpad.x +"|"+ gScratchpad.y ;
       }
              
       function showOpenManipulative(arg){
        	lz.embed.setCanvasAttribute('manipData',arg);
        }
        
        function dummy(){
        initScratchpad();
        showHideManipulative('scratchpad');
        }
        
        function manipOutOfFrameCheck(testClientMouseUp) {
        	lz.embed.setCanvasAttribute('manipOutOfFrameCheck',testClientMouseUp);
        	document.getElementById('__lz1').contentWindow.accomPkg.releaseItem();
        }
        
        function enableHotKeys(arg) {
        	window.parent.enableHotKeys(arg);
        }
        
        function enableManipBar(arg) {
        	window.parent.enableManipBar(arg);
        }
        
         function hideTooltip() {
            window.parent.hideTooltip();
        }
       </script>

<body>
<input type="button" onclick="prepareJson();"
	style="display: none;"></input>
<input type="button" onclick="dummy();"
	style="display: none;"></input>
<div id="appcontainer"></div>

<script type="text/javascript" defer>
                  lz.embed.resizeWindow('100%', '100%');
                  lz.embed.dhtml({url: 'Test.js', lfcurl: 'lps-dhtml/lps/includes/lfc/LFCdhtml.js', serverroot: 'lps/resources/', bgcolor: '#ffffff', width: '100%', height: '100%', id: 'lzapp', accessible: 'false', cancelmousewheel: false, cancelkeyboardcontrol: false, skipchromeinstall: false, usemastersprite: false, approot: '', appenddivid: 'appcontainer'});
                  lz.embed.applications.lzapp.onload = function loaded() {
                    // called when this application is done loading
                    
                  }
                </script>
<noscript>Please enable JavaScript in order to use this
application.</noscript>
</body>
</html>
