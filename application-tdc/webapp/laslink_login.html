<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
<TITLE> Presentation Canvas </TITLE>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <meta http-equiv="X-UA-Compatible" content="chrome=1">
   <link rel="SHORTCUT ICON" href="http://www.laszlosystems.com/favicon.ico">
   <meta name="viewport" content="width=device-width; initial-scale=1.0;">
   <script type="text/javascript" src="lps/includes/embed-compressed.js"></script>
   <SCRIPT SRC="includes/embed.js" type="text/javascript"/>
   <!--[if lt IE 9]><script type="text/javascript" src="lps/includes/excanvas.js"></script><![endif]-->
<SCRIPT SRC="includes/embed.js" type="text/javascript">
</SCRIPT>
  <link rel="stylesheet" href="lps/style_mozilla.css" type="text/css" /> 
	<script type="text/javascript"src="lps/jquery.min.js"></script>
	<script type="text/javascript"src="lps/jquery-1.5.2.js"></script>
	<script type="text/javascript" src="lps/jquery.magnifier.js"></script>
	<script type="text/javascript" src="lps/jquery.blockUI.js"></script>
	
<style title="mystyle" type="text/css" rel="stylesheet">
            html, body
            {
                /* http://www.quirksmode.org/css/100percheight.html */
                height: 100%;
                /* prevent browser decorations */
                margin: 0;
                padding: 0;
                border: 0 none;
            }
            body {
                background-color: #6691b4;
            }
            img { border: 0 none; }
        </style>
<SCRIPT LANGUAGE="JavaScript">
<!--
var _LDB_BypassSetFocusOnPageLoad = 0;
var spText;
var fontAccom;
var backColorString;
var itemSet = false;
var ansSet = false;
var readable = false;
var iid = null;

function showFootnote(header)
{
	lz.embed.setCanvasAttribute("footnotedata", header);
}

function isMac(){
	return (window.navigator.platform.indexOf("Mac") != -1);
}

function closeBrowser()
{
	if(isMac()){
		window.close();
	}
	else{
		LDBJSBridgeCTL.closeLockdownBrowser();
	}
}

function swfCallback(isPlaying, id) {
	var attr = 'isMultiAudio=true,isPlaying='+isPlaying+',audioId='+id;
	lzSetCanvasAttribute('isMultiAudio',attr);
}

function updateLDB(){
	_LDB_BypassSetFocusOnPageLoad = 1;
}

function sendRequest(method,xml,action){
	 // alert("sendRequest"+method+" "+xml+" "+action);
}

function checkVals(arg1,arg2,arg3){
	// alert("inside checkVals "+arg1+arg2+arg3);
}

function checkQues(arg1,arg2,arg3){
	// alert("inside checkQues "+arg1+arg2+arg3);
}

function checkStop(arg1,arg2,arg3){
	 // alert("inside checkStop arg1="+arg1+" arg2="+arg2+" arg3="+arg3);
}

function setResponse(result) {
	//console.log("setResponse"+result);
	//lz.embed.setCanvasAttribute("response",result);
	//gCommunicator.finishCall(data);
}

function buttonClicked(obj){
	//document.getElementById('mybutton').click();
}

function closeMagnifier(){
  var olddiv = document.getElementById('mglass');
  if (olddiv && olddiv.parentNode && olddiv.parentNode.removeChild)
	olddiv.parentNode.removeChild(olddiv);
}

function setFrameSource(filepath,tranX,tranY){
    alert(filepath+tranX+tranY);
    
    var s = document.getElementById('__lz0');
    s.setAttribute("src",filepath);
    lz.embed.setCanvasAttribute("TEItemLoaded", true);
}

function blockiPADUI(){
	console.log("block!!!!!");
	$.blockUI();
}

function unblockiPADUI () {
	console.log("unblock!!!!!");
	$.unblockUI();
}

function stepNavigateBackBlock(ref){
	             setTimeout(function(){
                 	ref.stepNavigateBack();
                  }, 200);  		
}

function stepNavigateForwardBlock(ref){
	             setTimeout(function(){
                  	ref.stepNavigateForward();
                  }, 200);  		
}
 
function iframeState(){
   	var iframe = document.getElementById('__lz0');
   	
   	if(iframe){
		if (navigator.userAgent.indexOf("MSIE") > -1 && !window.opera) {
		  iframe.onreadystatechange = function(){
		    if (iframe.readyState == "complete"){
		      	setAnswerNow('complete');
		 		var fontObj = getFontAccomodation();	
		 		var bgColorObj = getBackColorAccomodation();				    	
		    	if(fontObj.hasFont == 'true'){
		    		if(fontObj.hasFontMag == 'true'){
		    			document.getElementById('__lz0').contentWindow.accomPkg.setVisualAccessFeatures(fontObj.fgcolor, '18px',bgColorObj);
		    		}
		    		else {
		    			document.getElementById('__lz0').contentWindow.accomPkg.setVisualAccessFeatures(fontObj.fgcolor, '12px',bgColorObj);
		    		}
		    	}else{
		    		document.getElementById('__lz0').contentWindow.accomPkg.setVisualAccessFeatures('', '12px',bgColorObj);
		    	}			    	
		      	document.getElementById('__lz0').contentWindow.translate(xscalefactorjs,yscalefactorjs);
		    }
		  };
		} else {
		  iframe.onload = function(){
		    setAnswerNow('complete');
		    
     		var fontObj = getFontAccomodation();	
     		var bgColorObj = getBackColorAccomodation();				    	
     		
	    	if(fontObj.hasFont == 'true'){
	    		if(fontObj.hasFontMag == 'true'){
	    			document.getElementById('__lz0').contentWindow.accomPkg.setVisualAccessFeatures(fontObj.fgcolor, '18px',bgColorObj);
	    		}
	    		else {
	    			document.getElementById('__lz0').contentWindow.accomPkg.setVisualAccessFeatures(fontObj.fgcolor, '12px',bgColorObj);
	    		}
	    	}else{
	    		document.getElementById('__lz0').contentWindow.accomPkg.setVisualAccessFeatures('', '12px',bgColorObj);
	    	}
		  };
		}
	}
}

function checkHtml(arg1,arg2){
	// alert(arg1+arg2);
}

function destroyDiv(divElem) {
     var div = document.getElementById(divElem);
     if(div != null)
     	div.parentNode.removeChild(div);
}
 
function setAnswerNow(args){
	lz.embed.setCanvasAttribute('setanswer',args);
}
function freezeUI(){
if(document.getElementById('__lz0')){
		document.getElementById('__lz0').contentWindow.freezeUI();
	}
}

function getFontAccomodation(){
	var fontAccom = lz.embed.lzapp.getCanvasAttribute('fontString');
	fontAccom = fontAccom.split("|");
	var fontObj = new Object();
	fontObj.hasFont = fontAccom[0];
	fontObj.bgcolor = fontAccom[1].replace('0x', '#');
	fontObj.fgcolor = fontAccom[2].replace('0x', '#');
	fontObj.hasFontMag = fontAccom[3];
	return fontObj;
}

function getBackColorAccomodation(){
	var backColorString = lz.embed.lzapp.getCanvasAttribute('backColorString');
	backColorString = backColorString.split("|");
	var bgColorObj = new Object();
	bgColorObj.stemArea = backColorString[0].replace('0x', '#');
	bgColorObj.responseArea = backColorString[1].replace('0x', '#');
	return bgColorObj;
}
function setFootnoteText(arg){
	lz.embed.setCanvasAttribute('footnotetext',arg);
}

function isAnswered(){
  var elem = document.getElementById('__lz0');
 	if(elem){
 	if(elem.contentWindow.accomPkg)
  	return elem.contentWindow.accomPkg.isItemAnswered();
 }        	
  }
  
  function getState(){
   var elem = document.getElementById('__lz0');
  if(elem){
  		if(elem.contentWindow.accomPkg)
  		return document.getElementById('__lz0').contentWindow.accomPkg.getState();
  	}        
  }
  
  function setState(htmlContent,jsonContent,checkedVals){
  	var elem = document.getElementById('__lz0');
  	if(elem){	
      if(elem.contentWindow){
      		
      		if(document.getElementById('__lz0').contentWindow.accomPkg && ansSet == false){
   			document.getElementById('__lz0').contentWindow.accomPkg.setState(htmlContent,jsonContent,checkedVals);
   			ansSet = true;
   		}
   	}
  	}          
  }
  
  function setItemId(itemId){
	iframeState();
   	if (itemSet == false){
   	lz.embed.setCanvasAttribute('srcurl',itemId);
   	iid = itemId;
   	itemSet = true;
   		
   	}
  }
  
    function loginBlock(ref){
  		             setTimeout(function(){
                    	ref.login();
                    }, 200);  		
  }
  
  function loadItemBlock(ref){
  		             setTimeout(function(){
                    	ref.loadItem();
                    }, 200);  		
  }
  
  function setImageSize(divid, imgWidth, imgHeight) {
	//console.log("setImageSize************",divid,imgWidth,imgHeight)
	var elm = document.getElementById(divid);
	if(elm != null) {
		var imgElm = elm.getElementsByTagName("img");
		if(imgElm != null) {
			imgElm[0].setAttribute("width", imgWidth);
			imgElm[0].setAttribute("height", imgHeight);	
		}
	}					
 }
 
 var gDivid;
 var gImgWidth;
 var gImgHeight;
 
 function setManipState(args){
	lz.embed.setCanvasAttribute('manipstate',args);
}

function setTTStext(args){
	lz.embed.setCanvasAttribute('ttstext',args);
}

function setAnswerNow(args){
	lz.embed.setCanvasAttribute('setanswer',args);
}
function getReadable(){
	return lz.embed.lzapp.getCanvasAttribute('readable');
}

function freezeUI(){
var elementArr = document.getElementsByTagName('iframe');
if(elementArr[0].id){
		document.getElementById(elementArr[0].id).contentWindow.freezeUI();
	}
}

function unlockUI(){
var elementArr = document.getElementsByTagName('iframe');
if(elementArr[0].id){
		document.getElementById(elementArr[0].id).contentWindow.unlockUI();
	}
}

function setScaleFactor(args){

	args = args.split('|');
	xscalefactor = args[0];
	yscalefactor = args[1];
	
}
function getFontAccomodation(){
	var fontAccom = lz.embed.lzapp.getCanvasAttribute('fontString');
	fontAccom = fontAccom.split("|");
	var fontObj = new Object();
	fontObj.hasFont = fontAccom[0];
	fontObj.bgcolor = fontAccom[1].replace('0x', '#');
	fontObj.fgcolor = fontAccom[2].replace('0x', '#');
	fontObj.hasFontMag = fontAccom[3];
	return fontObj;
}

function getBackColorAccomodation(){
	var backColorString = lz.embed.lzapp.getCanvasAttribute('backColorString');
	backColorString = backColorString.split("|");
	var bgColorObj = new Object();
	bgColorObj.stemArea = backColorString[0].replace('0x', '#');
	bgColorObj.responseArea = backColorString[1].replace('0x', '#');
	return bgColorObj;
}
function setHtmlGeneralManip(htmlGeneralManip){
  	lz.embed.setCanvasAttribute('htmlManip',htmlGeneralManip);
}
 
 function onImgZoomIn(divid, imgWidth, imgHeight) {
	gDivid = divid;
	gImgWidth = imgWidth;	
	gImgHeight = imgHeight;
 }
 
 function onImgZoomOut() {
	setImageSize(gDivid, gImgWidth, gImgHeight);
	gDivid = '';
	gImgWidth = 0;	
	gImgHeight = 0;
 }
 
 function exitPleaseWaitPopup(){
	lz.embed.setCanvasAttribute('exitPleaseWaitPopup','true');
}

function getOpenManipData(){
	return lz.embed.lzapp.getCanvasAttribute('htmlOpenManip');
}

function setFocusOnScratchpad(){
var elementArr = document.getElementsByTagName('iframe');
document.getElementById(elementArr[0].id).contentWindow.setFocus();
}

function callManipOutOfFrameCheck(testClientMouseUp) {
	var elementArr = document.getElementsByTagName('iframe');
	if(elementArr[0] != null && elementArr[0] != undefined && elementArr[0].id) {
		document.getElementById(elementArr[0].id).contentWindow.manipOutOfFrameCheck(testClientMouseUp);
	}
}


function callTestMouseUp1() {
   	lz.embed.setCanvasAttribute('testMouseUp','true');
}


function fromWrapper() {
	lz.embed.setCanvasAttribute('fromWrapper','true');
}
 
 function showMagnify() {	
		if(jQuery("#magnifierWindow").length < 1){
			jQuery('body').addpowerzoom({
					defaultpower: 1.5,
					powerrange: [1.5,2],
					largeimage: null,
					magnifiersize: [300,100] 
				});
		}	
		jQuery(ddpowerzoomer.$magnifier.outer).hide();
		jQuery.ajax({
			url: "servlet/PersistenceServlet.do?method=captureScreenshot",
			dataType: "xml",
			success: function(data) {
			//xmlDoc = jQuery.parseXML( data ),
		    xml = jQuery( data ),
		    ok = xml.find( "OK" );
			//alert(ok);
			var timeStamp = ok.text();//jQuery(jQuery.parseXML(data)).find("ok").text();
			//alert(timeStamp);
			var imageName = "cache/screenshot"+timeStamp+".png"
			
			jQuery(ddpowerzoomer.$magnifier.outer).css('left',(document.body.clientWidth/2 - 165)+ 'px');
			jQuery(ddpowerzoomer.$magnifier.outer).css('top',(document.body.clientHeight/2 - 75) + 'px');
			jQuery(ddpowerzoomer.$magnifier.outer).show();
			jQuery(ddpowerzoomer).initMagnify({largeimage:imageName});
			}
		});
			
		
	}
	
function hideMagnify() {		
	
	jQuery(ddpowerzoomer.$magnifier.outer).hide();
}

/* Method to reinstate the magnifier to previous state */
function displayMagnifier() {		
	
	jQuery(ddpowerzoomer.$magnifier.outer).show();
}

function setMouseUpVal() {
	lz.embed.setCanvasAttribute('mouseUpFired','false');
}

var currentFrameId;
function frameID(frameid){
	currentFrameId = frameid;
}
function load() {
	
     var myservlet = 'servlet/PersistenceServlet.do?method=isProductCheck&folder=calif&requestXML=';
     $.get(myservlet, function(data) {
	     //alert(data);
	     if(data.childNodes[0].nodeName.indexOf('ISTEP') >= 0){
	     	loadJsApplication();
	     }else {
	     	loadSwfApplication();
	     }
	 });
}

//-->
</SCRIPT>
</HEAD>

<BODY topmargin=0 leftmargin=0 rightmargin=0 bottommargin=0 scroll=no bgcolor="#6691B4" onload="load()">

<div id="appcontainer">
			<script type="text/javascript" defer>
                  function loadJsApplication(){
	                  lz.embed.dhtml({url: 'TestClient.js?servletUrl=/servlet', lfcurl: 'lps/includes/lfc/LFCdhtml.js', serverroot: 'lps/resources/', bgcolor: '#6691b4', width: '100%', height: '100%', id: 'lzapp', accessible: 'true', cancelmousewheel: false, cancelkeyboardcontrol: false, skipchromeinstall: false, usemastersprite: false, approot: '', appenddivid: 'appcontainer'});
	                  lz.embed.applications.lzapp.onload = function loaded() {
	                    // called when this application is done loading
	                    
	                  }
                  }
                  function loadSwfApplication(){
	                  lz.embed.resizeWindow('100%', '100%');
	                  lz.embed.swf({url: 'TestClient.lzx.swf?&lzr=swf10&folder=calif&servletUrl=/servlet&eliminatorResource=resources/eliminator.swf', allowfullscreen: 'false', bgcolor: '#6691B4', width: '100%', height: '100%', id: 'lzapp', accessible: 'false', cancelmousewheel: false, appenddivid: 'appcontainer', wmode: 'opaque'});
					  //lz.embed.swf({url: 'TestClient.lzx.swf?&lzr=swf10&folder=calif&servletUrl=http://192.168.2.2:12345/servlet/fixed&eliminatorResource=resources/eliminator.swf', allowfullscreen: 'false', bgcolor: '#6691B4', width: '100%', height: '100%', id: 'lzapp', accessible: 'false', cancelmousewheel: false, appenddivid: 'appcontainer'});
					  	
	                  lz.embed.applications.lzapp.onloadstatus = function loadstatus(p) {
	                    // called with a percentage (0-100) indicating load progress
	                    var el = document.getElementById('lzsplashtext');
	                    if (el) {
	                        if (p == 100) {
	                            var splash = document.getElementById('lzsplash');
	                            if (splash) {
	                                splash.parentNode.removeChild(splash);
	                            }
	                        } else {
	                            el.innerHTML = p + '% loaded'
	                        }
	                    }
	                  }
	
	                  lz.embed.applications.lzapp.onload = function loaded() {
	                    // called when this application is done loading and the 
	                    // canvas has initted
	                  }
                  }
                </script>
            <noscript>
                Please enable JavaScript in order to use this application.
            </noscript>
</div>
	<OBJECT ID="LDBJSBridgeCTL" CLASSID="CLSID:56871AC2-4683-4D8E-B5EB-E7E3AA40DD52" VIEWASTEXT WIDTH=0 HEIGHT = 0></OBJECT>
</BODY>
</HTML>
